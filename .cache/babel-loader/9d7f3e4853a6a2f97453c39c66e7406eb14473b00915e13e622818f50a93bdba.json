{"ast":null,"code":"// JavaScript function to encrypt a string message using AES encryption in CBC mode\nfunction encryptMessage(message, username) {\n  const CryptoJS = require('crypto-js');\n  const keyHex = CryptoJS.enc.Utf8.parse(`${process.env.REACT_APP_AES_SECRET_KEY}`);\n  const iv = CryptoJS.lib.WordArray.random(16);\n  const encrypted = CryptoJS.AES.encrypt(message, keyHex, {\n    iv: iv,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n  });\n  const ciphertext = iv.concat(encrypted.ciphertext).toString(CryptoJS.enc.Base64);\n  return ciphertext;\n}\nexport default encryptMessage;","map":{"version":3,"names":["encryptMessage","message","username","CryptoJS","require","keyHex","enc","Utf8","parse","process","env","REACT_APP_AES_SECRET_KEY","iv","lib","WordArray","random","encrypted","AES","encrypt","mode","CBC","padding","pad","Pkcs7","ciphertext","concat","toString","Base64"],"sources":["/Users/akshayg/Personal/blog/blog/src/components/Utilities/aes.js"],"sourcesContent":["// JavaScript function to encrypt a string message using AES encryption in CBC mode\nfunction encryptMessage(message, username) {\n    const CryptoJS = require('crypto-js');\n    \n    const keyHex = CryptoJS.enc.Utf8.parse(`${process.env.REACT_APP_AES_SECRET_KEY}`);\n    \n    const iv = CryptoJS.lib.WordArray.random(16);\n    \n    const encrypted = CryptoJS.AES.encrypt(message, keyHex, {\n      iv: iv,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7\n    });\n\n    const ciphertext = iv.concat(encrypted.ciphertext).toString(CryptoJS.enc.Base64);\n    return ciphertext;\n  }\n\n  export default encryptMessage"],"mappings":"AAAA;AACA,SAASA,cAAcA,CAACC,OAAO,EAAEC,QAAQ,EAAE;EACvC,MAAMC,QAAQ,GAAGC,OAAO,CAAC,WAAW,CAAC;EAErC,MAAMC,MAAM,GAAGF,QAAQ,CAACG,GAAG,CAACC,IAAI,CAACC,KAAK,CAAE,GAAEC,OAAO,CAACC,GAAG,CAACC,wBAAyB,EAAC,CAAC;EAEjF,MAAMC,EAAE,GAAGT,QAAQ,CAACU,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC;EAE5C,MAAMC,SAAS,GAAGb,QAAQ,CAACc,GAAG,CAACC,OAAO,CAACjB,OAAO,EAAEI,MAAM,EAAE;IACtDO,EAAE,EAAEA,EAAE;IACNO,IAAI,EAAEhB,QAAQ,CAACgB,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAElB,QAAQ,CAACmB,GAAG,CAACC;EACxB,CAAC,CAAC;EAEF,MAAMC,UAAU,GAAGZ,EAAE,CAACa,MAAM,CAACT,SAAS,CAACQ,UAAU,CAAC,CAACE,QAAQ,CAACvB,QAAQ,CAACG,GAAG,CAACqB,MAAM,CAAC;EAChF,OAAOH,UAAU;AACnB;AAEA,eAAexB,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}